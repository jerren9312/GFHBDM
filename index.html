<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grand Forks Historic Building Museum</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow: hidden;
      background: #000;
      color: white;
    }
    
    /* å…¨å±3DèƒŒæ™¯ */
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      display: block;
      touch-action: none;
    }
    
    /* é¡¶éƒ¨å¯¼èˆªæ  */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 30px 50px;
      background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 24px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .nav-buttons {
      display: flex;
      gap: 15px;
    }
    
    .nav-btn {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 10px 20px;
      border-radius: 25px;
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .nav-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    
    .nav-btn.active {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.4);
    }
    
    /* ä¸­å¤®ä¿¡æ¯å¡ç‰‡ */
    .info-card {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 255, 255, 0.15);
      border-radius: 30px;
      padding: 50px 60px;
      max-width: 600px;
      z-index: 50;
      text-align: center;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
      animation: fadeInUp 0.8s ease;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translate(-50%, -40%);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%);
      }
    }
    
    .building-number {
      font-size: 16px;
      letter-spacing: 3px;
      color: #ffd89b;
      margin-bottom: 15px;
      font-weight: 600;
    }
    
    .building-title {
      font-size: 48px;
      font-weight: 800;
      margin-bottom: 15px;
      background: linear-gradient(135deg, #fff 0%, #ffd89b 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1.2;
    }
    
    .building-year {
      font-size: 18px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 25px;
      font-style: italic;
    }
    
    .building-description {
      font-size: 16px;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 35px;
    }
    
    .explore-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      padding: 15px 40px;
      border-radius: 30px;
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }
    
    .explore-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
    }
    
    /* å·¦å³åˆ‡æ¢æŒ‰é’® */
    .nav-arrow {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      width: 70px;
      height: 70px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 60;
      transition: all 0.3s ease;
      font-size: 28px;
    }
    
    .nav-arrow:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-50%) scale(1.1);
    }
    
    .nav-arrow.left {
      left: 40px;
    }
    
    .nav-arrow.right {
      right: 40px;
    }
    
    /* åº•éƒ¨è¿›åº¦æŒ‡ç¤ºå™¨ */
    .progress-dots {
      position: fixed;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
      z-index: 100;
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    
    .dot.active {
      background: white;
      transform: scale(1.3);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    }
    
    .dot:hover {
      background: rgba(255, 255, 255, 0.6);
    }
    
    /* æ§åˆ¶è¯´æ˜ */
    .controls-hint {
      position: fixed;
      bottom: 100px;
      left: 50px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      padding: 20px 25px;
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 50;
      font-size: 14px;
      line-height: 1.8;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .controls-hint.visible {
      display: block;
      opacity: 1;
    }
    
    /* è§†è§‰æ§åˆ¶é¢æ¿ */
    .camera-controls {
      position: fixed;
      bottom: 100px;
      right: 50px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      z-index: 50;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .camera-controls.visible {
      display: block;
      opacity: 1;
    }
    
    .camera-controls h4 {
      color: #ffd89b;
      margin-bottom: 15px;
      font-size: 16px;
      text-align: center;
    }
    
    .control-section {
      margin-bottom: 15px;
    }
    
    .control-section:last-child {
      margin-bottom: 0;
    }
    
    .control-label {
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      margin-bottom: 8px;
      text-align: center;
    }
    
    .control-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 10px;
    }
    
    .control-grid.vertical {
      grid-template-columns: 1fr;
    }
    
    .control-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 45px;
    }
    
    .control-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }
    
    .control-btn:active {
      background: rgba(255, 255, 255, 0.35);
      transform: scale(0.95);
    }
    
    .control-btn.center {
      grid-column: 2;
    }
    
    .control-divider {
      height: 1px;
      background: rgba(255, 255, 255, 0.2);
      margin: 12px 0;
    }
    
    .controls-hint h4 {
      font-size: 16px;
      margin-bottom: 10px;
      color: #ffd89b;
    }
    
    .controls-hint p {
      color: rgba(255, 255, 255, 0.8);
      margin: 5px 0;
    }
    
    /* FPSè®¡æ•°å™¨ */
    #fps {
      position: fixed;
      top: 30px;
      right: 50px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      padding: 10px 20px;
      border-radius: 10px;
      font-family: monospace;
      font-size: 14px;
      color: #51cf66;
      z-index: 100;
    }
    
    /* åŠ è½½åŠ¨ç”» */
    #spinner {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 200;
    }
    
    .spinner-ring {
      width: 80px;
      height: 80px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top: 4px solid #ffd89b;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    #message {
      color: white;
      font-size: 18px;
      font-weight: 500;
    }
    
    #progress {
      position: fixed;
      bottom: 0;
      left: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      z-index: 200;
      transition: width 0.3s ease;
    }
    
    #camid {
      display: none;
    }
    
    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .top-nav {
        padding: 20px 25px;
      }
      
      .logo {
        font-size: 18px;
      }
      
      .info-card {
        padding: 30px 35px;
        max-width: 90%;
      }
      
      .building-title {
        font-size: 32px;
      }
      
      .nav-arrow {
        width: 50px;
        height: 50px;
        font-size: 20px;
      }
      
      .nav-arrow.left {
        left: 20px;
      }
      
      .nav-arrow.right {
        right: 20px;
      }
      
      .controls-hint {
        display: none;
      }
      
      .camera-controls {
        bottom: 20px;
        right: 20px;
        left: 20px;
        max-width: 300px;
        margin: 0 auto;
      }
    }
    
    /* æ·¡å…¥æ·¡å‡ºåŠ¨ç”» */
    .fade-out {
      animation: fadeOut 0.5s ease forwards;
    }
    
    @keyframes fadeOut {
      to {
        opacity: 0;
      }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease forwards;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
  </style>
</head>
<body>
  <!-- å…¨å±3Dç”»å¸ƒ - ä½¿ç”¨åŸæ¥main.jsæœŸæœ›çš„ID -->
  <canvas id="canvas"></canvas>
  
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <div class="top-nav">
    <div class="logo">Grand Forks Historic Building Museum</div>
    <div class="nav-buttons">
      <button class="nav-btn" id="camera-btn" onclick="toggleCameraControls()">ğŸ“¹ Camera</button>
      <button class="nav-btn" id="controls-btn" onclick="toggleControls()">ğŸ® Controls</button>
      <button class="nav-btn" onclick="toggleFullscreen()">ğŸ–¥ï¸ Fullscreen</button>
      <button class="nav-btn" id="info-btn" onclick="showInfo()">â„¹ï¸ Info</button>
    </div>
  </div>
  
  <!-- FPSè®¡æ•°å™¨ -->
  <div id="fps">-- fps</div>
  
  <!-- éšè—çš„camidå…ƒç´ ï¼ˆmain.jså¯èƒ½éœ€è¦ï¼‰ -->
  <div id="camid"></div>
  
  <!-- ä¸­å¤®ä¿¡æ¯å¡ç‰‡ -->
  <div class="info-card" id="info-card">
    <div class="building-number" id="building-number">BUILDING 01/06</div>
    <h1 class="building-title" id="building-title">Historic Building 1</h1>
    <div class="building-year" id="building-year">Est. 1890s</div>
    <p class="building-description" id="building-description">
      A remarkable example of late 19th-century architecture, featuring classic Victorian design elements.
    </p>
    <button class="explore-button" onclick="hideInfoCard()">
      ğŸ” Explore in 3D
    </button>
  </div>
  
  <!-- å·¦å³åˆ‡æ¢æŒ‰é’® -->
  <div class="nav-arrow left" onclick="previousBuilding()">â€¹</div>
  <div class="nav-arrow right" onclick="nextBuilding()">â€º</div>
  
  <!-- åº•éƒ¨è¿›åº¦ç‚¹ -->
  <div class="progress-dots" id="progress-dots"></div>
  
  <!-- æ§åˆ¶è¯´æ˜ -->
  <div class="controls-hint">
    <h4>ğŸ® Controls</h4>
    <p><strong>Mouse Drag:</strong> Rotate view</p>
    <p><strong>Right Click:</strong> Pan camera</p>
    <p><strong>Scroll:</strong> Zoom</p>
    <p><strong>â† â†’:</strong> Switch buildings</p>
  </div>
  
  <!-- æ‘„åƒæœºæ§åˆ¶é¢æ¿ -->
  <div class="camera-controls">
    <h4>ğŸ“¹ Camera Controls</h4>
    
    <div class="control-section">
      <div class="control-label">Pan (å¹³ç§»)</div>
      <div class="control-grid">
        <div></div>
        <button class="control-btn" onclick="panCamera(0, 1)">â†‘</button>
        <div></div>
        <button class="control-btn" onclick="panCamera(-1, 0)">â†</button>
        <button class="control-btn" onclick="resetCamera()">âŒ‚</button>
        <button class="control-btn" onclick="panCamera(1, 0)">â†’</button>
        <div></div>
        <button class="control-btn" onclick="panCamera(0, -1)">â†“</button>
        <div></div>
      </div>
    </div>
    
    <div class="control-divider"></div>
    
    <div class="control-section">
      <div class="control-label">Rotate (æ—‹è½¬)</div>
      <div class="control-grid">
        <button class="control-btn" onclick="rotateCamera(-15, 0)">â†¶</button>
        <button class="control-btn" onclick="rotateCamera(0, 15)">â¤´</button>
        <button class="control-btn" onclick="rotateCamera(15, 0)">â†·</button>
        <div></div>
        <button class="control-btn" onclick="rotateCamera(0, -15)">â¤µ</button>
        <div></div>
      </div>
    </div>
    
    <div class="control-divider"></div>
    
    <div class="control-section">
      <div class="control-label">Zoom (ç¼©æ”¾)</div>
      <div class="control-grid">
        <button class="control-btn" onclick="zoomCamera(-0.5)">â–</button>
        <button class="control-btn" onclick="resetZoom()">âŠ™</button>
        <button class="control-btn" onclick="zoomCamera(0.5)">â•</button>
      </div>
    </div>
  </div>
  
  <!-- åŠ è½½åŠ¨ç”» -->
  <div id="spinner">
    <div class="spinner-ring"></div>
    <p id="message">Loading 3D Model...</p>
  </div>
  
  <!-- è¿›åº¦æ¡ -->
  <div id="progress" style="width: 0%;"></div>

  <script>
    // CORSä»£ç†å‡½æ•° - å¯ä»¥é€‰æ‹©ä¸åŒçš„ä»£ç†æœåŠ¡
    function getCorsProxyUrl(url) {
      // å¦‚æœæ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œç›´æ¥è¿”å›
      if (!url.startsWith('http')) {
        return url;
      }
      
      // Hugging Face é“¾æ¥ä¸éœ€è¦ä»£ç†ï¼ŒåŸç”Ÿæ”¯æŒCORS
      if (url.includes('huggingface.co')) {
        return url;
      }
      
      // å¦‚æœå·²ç»æ˜¯ä»£ç†URLï¼Œç›´æ¥è¿”å›
      if (url.includes('corsproxy.io')) {
        return url;
      }
      
      // å…¶ä»–é“¾æ¥ä½¿ç”¨ corsproxy.io ä»£ç†
      return 'https://corsproxy.io/?' + encodeURIComponent(url);
      
      // å¤‡é€‰ä»£ç†ï¼ˆå¦‚æœä¸Šé¢çš„ä¸å·¥ä½œï¼Œå¯ä»¥åˆ‡æ¢åˆ°è¿™äº›ï¼‰:
      // return 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
      // return 'https://cors-anywhere.herokuapp.com/' + url;
    }
    
    // å»ºç­‘æ•°æ®
    const buildings = [
      {
        model: 'model1.splat',  // æœ¬åœ°æ–‡ä»¶
        name: 'Historic Building 1',
        year: 'Est. 1890s',
        description: 'A remarkable example of late 19th-century architecture, featuring classic Victorian design elements.'
      },
      {
        // Hugging Face é“¾æ¥ - æ³¨æ„ä½¿ç”¨ resolve è€Œä¸æ˜¯ blob
        model: 'https://huggingface.co/datasets/jerren9312/GFHBDM/resolve/main/model2.splat',
        name: 'Historic Building 2',
        year: 'Est. 1900s',
        description: 'An important commercial structure that shaped the early downtown development.'
      },
      {
        model: 'model3.splat',
        name: 'Historic Building 3',
        year: 'Est. 1910s',
        description: 'A beautiful example of early 20th-century civic architecture with neoclassical influences.'
      },
      {
        model: 'model4.splat',
        name: 'Historic Building 4',
        year: 'Est. 1920s',
        description: 'Art Deco masterpiece showcasing the prosperity and optimism of the Jazz Age.'
      },
      {
        model: 'model5.splat',
        name: 'Historic Building 5',
        year: 'Est. 1930s',
        description: 'Depression-era construction demonstrating resilient community spirit and craftsmanship.'
      },
      {
        model: 'model6.splat',
        name: 'Historic Building 6',
        year: 'Est. 1940s',
        description: 'Post-war modernist structure representing Grand Forks\' mid-century development.'
      }
    ];
    
    let currentIndex = 0;
    let infoCardVisible = true;
    let controlsVisible = false;
    let cameraControlsVisible = false;
    
    // æ‘„åƒæœºçŠ¶æ€ï¼ˆå¦‚æœmain.jsæš´éœ²äº†ç›¸å…³APIï¼‰
    let cameraState = {
      x: 0,
      y: 0,
      z: 5,
      rotationX: 0,
      rotationY: 0,
      zoom: 1
    };
    
    // åˆå§‹åŒ–è¿›åº¦ç‚¹
    function initProgressDots() {
      const dotsContainer = document.getElementById('progress-dots');
      buildings.forEach((_, index) => {
        const dot = document.createElement('div');
        dot.className = 'dot';
        if (index === 0) dot.classList.add('active');
        dot.onclick = () => switchToBuilding(index);
        dotsContainer.appendChild(dot);
      });
    }
    
    // æ›´æ–°ä¿¡æ¯å¡ç‰‡
    function updateInfoCard() {
      const building = buildings[currentIndex];
      document.getElementById('building-number').textContent = `BUILDING ${String(currentIndex + 1).padStart(2, '0')}/${String(buildings.length).padStart(2, '0')}`;
      document.getElementById('building-title').textContent = building.name;
      document.getElementById('building-year').textContent = building.year;
      document.getElementById('building-description').textContent = building.description;
      
      // æ›´æ–°è¿›åº¦ç‚¹
      document.querySelectorAll('.dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentIndex);
      });
    }
    
    // åˆ‡æ¢åˆ°æŒ‡å®šå»ºç­‘
    function switchToBuilding(index) {
      if (index === currentIndex) return;
      currentIndex = index;
      const building = buildings[currentIndex];
      
      // ä½¿ç”¨CORSä»£ç†URL
      const modelUrl = getCorsProxyUrl(building.model);
      
      // æ›´æ–°URLå‚æ•°å¹¶é‡æ–°åŠ è½½
      const newUrl = new URL(window.location.href);
      newUrl.searchParams.set('url', modelUrl);
      window.location.href = newUrl.toString();
    }
    
    // ä¸Šä¸€ä¸ªå»ºç­‘
    function previousBuilding() {
      const newIndex = (currentIndex - 1 + buildings.length) % buildings.length;
      switchToBuilding(newIndex);
    }
    
    // ä¸‹ä¸€ä¸ªå»ºç­‘
    function nextBuilding() {
      const newIndex = (currentIndex + 1) % buildings.length;
      switchToBuilding(newIndex);
    }
    
    // éšè—ä¿¡æ¯å¡ç‰‡
    function hideInfoCard() {
      const card = document.getElementById('info-card');
      const infoBtn = document.getElementById('info-btn');
      card.classList.add('fade-out');
      infoBtn.classList.remove('active');
      setTimeout(() => {
        card.style.display = 'none';
        infoCardVisible = false;
      }, 500);
    }
    
    // æ˜¾ç¤ºä¿¡æ¯
    function showInfo() {
      const card = document.getElementById('info-card');
      const infoBtn = document.getElementById('info-btn');
      
      if (infoCardVisible) {
        hideInfoCard();
        infoBtn.classList.remove('active');
      } else {
        card.style.display = 'block';
        card.classList.remove('fade-out');
        card.classList.add('fade-in');
        infoBtn.classList.add('active');
        infoCardVisible = true;
      }
    }
    
    // åˆ‡æ¢æ§åˆ¶è¯´æ˜æ˜¾ç¤º/éšè—
    function toggleControls() {
      const controls = document.querySelector('.controls-hint');
      const controlsBtn = document.getElementById('controls-btn');
      
      if (controlsVisible) {
        controls.classList.remove('visible');
        controlsBtn.classList.remove('active');
        controlsVisible = false;
      } else {
        controls.classList.add('visible');
        controlsBtn.classList.add('active');
        controlsVisible = true;
      }
    }
    
    // åˆ‡æ¢æ‘„åƒæœºæ§åˆ¶é¢æ¿
    function toggleCameraControls() {
      const cameraControls = document.querySelector('.camera-controls');
      const cameraBtn = document.getElementById('camera-btn');
      
      if (cameraControlsVisible) {
        cameraControls.classList.remove('visible');
        cameraBtn.classList.remove('active');
        cameraControlsVisible = false;
      } else {
        cameraControls.classList.add('visible');
        cameraBtn.classList.add('active');
        cameraControlsVisible = true;
      }
    }
    
    // æ‘„åƒæœºæ§åˆ¶å‡½æ•°
    function panCamera(x, y) {
      // è§¦å‘é”®ç›˜äº‹ä»¶æ¥ç§»åŠ¨æ‘„åƒæœº
      const speed = 0.1;
      cameraState.x += x * speed;
      cameraState.y += y * speed;
      
      // æ¨¡æ‹Ÿé”®ç›˜æŒ‰é”®ï¼ˆå¦‚æœmain.jsæ”¯æŒWASDæˆ–æ–¹å‘é”®æ§åˆ¶ï¼‰
      const keyMap = {
        '0,1': 'ArrowUp',
        '0,-1': 'ArrowDown', 
        '-1,0': 'ArrowLeft',
        '1,0': 'ArrowRight'
      };
      
      const key = keyMap[`${x},${y}`];
      if (key) {
        // æ¨¡æ‹Ÿå¤šæ¬¡æŒ‰é”®ä»¥å®ç°ç§»åŠ¨
        for(let i = 0; i < 3; i++) {
          setTimeout(() => {
            const event = new KeyboardEvent('keydown', { key: key });
            document.dispatchEvent(event);
          }, i * 50);
        }
      }
    }
    
    function rotateCamera(yaw, pitch) {
      cameraState.rotationX += pitch;
      cameraState.rotationY += yaw;
      
      // å¦‚æœmain.jsæš´éœ²äº†æ—‹è½¬APIï¼Œåœ¨è¿™é‡Œè°ƒç”¨
      // å¦åˆ™é€šè¿‡æ¨¡æ‹Ÿé¼ æ ‡æ‹–æ‹½å®ç°
      console.log('Rotate camera:', yaw, pitch);
    }
    
    function zoomCamera(delta) {
      cameraState.zoom += delta;
      
      // æ¨¡æ‹Ÿæ»šè½®äº‹ä»¶
      const event = new WheelEvent('wheel', {
        deltaY: -delta * 100,
        bubbles: true
      });
      document.getElementById('canvas').dispatchEvent(event);
    }
    
    function resetCamera() {
      cameraState = {
        x: 0,
        y: 0,
        z: 5,
        rotationX: 0,
        rotationY: 0,
        zoom: 1
      };
      
      // é‡æ–°åŠ è½½é¡µé¢ä»¥é‡ç½®æ‘„åƒæœº
      // location.reload();
      
      // æˆ–è€…è§¦å‘é‡ç½®äº‹ä»¶ï¼ˆå¦‚æœmain.jsæ”¯æŒï¼‰
      console.log('Reset camera to default position');
    }
    
    function resetZoom() {
      cameraState.zoom = 1;
      console.log('Reset zoom');
    }
    
    // å…¨å±åˆ‡æ¢
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }
    
    // é”®ç›˜æ§åˆ¶
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' && !cameraControlsVisible) {
        previousBuilding();
      } else if (e.key === 'ArrowRight' && !cameraControlsVisible) {
        nextBuilding();
      } else if (e.key === 'i' || e.key === 'I') {
        showInfo();
      } else if (e.key === 'f' || e.key === 'F') {
        toggleFullscreen();
      } else if (e.key === 'c' || e.key === 'C') {
        toggleControls();
      } else if (e.key === 'v' || e.key === 'V') {
        toggleCameraControls();
      }
    });
    
    // åˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', () => {
      initProgressDots();
      
      // æ£€æŸ¥URLå‚æ•°ï¼Œç¡®å®šå½“å‰æ˜¾ç¤ºå“ªä¸ªå»ºç­‘
      const urlParams = new URLSearchParams(window.location.search);
      const currentModel = urlParams.get('url');
      
      if (currentModel) {
        const index = buildings.findIndex(b => b.model === currentModel || getCorsProxyUrl(b.model) === currentModel);
        if (index !== -1) {
          currentIndex = index;
        }
      } else {
        // å¦‚æœæ²¡æœ‰URLå‚æ•°ï¼ŒåŠ è½½ç¬¬ä¸€ä¸ªå»ºç­‘
        const modelUrl = getCorsProxyUrl(buildings[0].model);
        const newUrl = new URL(window.location.href);
        newUrl.searchParams.set('url', modelUrl);
        window.history.replaceState({}, '', newUrl);
      }
      
      updateInfoCard();
      
      // å»¶é•¿è‡ªåŠ¨éšè—æ—¶é—´åˆ°8ç§’ï¼Œå¹¶ä¸”ç»™ç”¨æˆ·æç¤º
      setTimeout(() => {
        if (infoCardVisible) {
          hideInfoCard();
        }
      }, 8000);
    });
  </script>
  
  <!-- åŠ è½½main.js - æ”¾åœ¨æœ€åä»¥ç¡®ä¿DOMå·²å‡†å¤‡å¥½ -->
  <script src="main.js"></script>
</body>
</html>
